<!DOCTYPE html>
<html lang="en" ng-app="ArtifactFeederApp">
	<head>
		<title>Venice Missing Treasures Collage</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

		<!-- Firebase -->
		<script type='text/javascript' src='https://cdn.firebase.com/v0/firebase.js'></script>

		<!-- jquery -->
		<!--[if lt IE 9]>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<![endif]-->
		<!--[if (gte IE 9) | (!IE)]><!-->
		<!--script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script-->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js" type="text/javascript"></script>
		<!--<![endif]-->

		<!--[if IE]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

		<!-- Leaflet -->
		<script src="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.js"></script>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.4/leaflet.css" />

		<!-- bootstrap -->
		<!--link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css"/>
		<script type='text/javascript' src='js/bootstrap.min.js'></script-->

		<!-- angularjs -->
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.0rc1/angular-route.js"></script>

		<!-- spinner -->
		<!--script type='text/javascript' src='js/spin.min.js'></script>
		<script type='text/javascript' src='js/jquery.spin.js'></script-->

		<!-- imagesLoaded -->
		<script src="http://imagesloaded.desandro.com/imagesloaded.pkgd.min.js" type="text/javascript"></script>


		<script type="text/javascript" src='javascripts/StandardizedDataSet.js'></script>


		<!-- Angular -->
		<script type='text/javascript' src='javascripts/app.js'></script>
		<script type='text/javascript' src='javascripts/ck-console.js'></script>
		<script type="text/javascript" src='javascripts/controller.js'></script>
		<script type="text/javascript" src='javascripts/services.js'></script>
		<!--script type="text/javascript" src='javascripts/dataLoad.js'></script-->

		<link rel="stylesheet" type="text/css" href="css/transitions.css" media="all" />
		<link rel="stylesheet" type="text/css" href="css/collageTags.css" media="all" />
		<link rel="stylesheet" type="text/css" href="css/collageOverlay.css" media="all" />

		<script src="javascripts/jquery-collagePlus/jquery.collagePlus.js"></script>
		<script src="javascripts/jquery-collagePlus/jquery.removeWhitespace.js"></script>
		<script src="javascripts/jquery-collagePlus/jquery.collageCaption.js"></script>
		<script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		<!--script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/fancybox/1.3.4/jquery.fancybox-1.3.4.pack.min.js"></script-->

		<script type="text/javascript">
			//This code is only nessasary if hosting it on a page secured with https
			function setCookie(cname, cvalue, exdays) {
				var d = new Date();
				d.setTime(d.getTime() + (exdays*24*60*60*1000));
				var expires = "expires="+d.toUTCString();
				document.cookie = cname + "=" + cvalue + "; " + expires;
			}
			function getCookie(cname) {
				var name = cname + "=";
				var ca = document.cookie.split(';');
				for(var i=0; i<ca.length; i++) {
					var c = ca[i];
					while (c.charAt(0)==' ') c = c.substring(1);
					if (c.indexOf(name) != -1) return c.substring(name.length,c.length);
				}
				return "";
			}
			//End HTTPS info code

			function getTags(){
				var text = self.location.search;
				if(text == "")return [];
				var theleft = text.lastIndexOf("?") + 1;
				return text.substring(theleft, text.length).split(',');
			}


			// Here we apply the actual CollagePlus plugin
			function collage() {
				$('.Collage').removeWhitespace().collagePlus(
					{
						'fadeSpeed'	 : 2000,
						'targetHeight'  : 250,
						'allowPartialLastRow' : true
					}
				);
			};

		</script>
	</head>
	<body>
		<script type="text/javascript">
			var tags = getTags();

			function toggleTag(tagName){
				console.log("Toggle Tag");
				var i = tags.indexOf(tagName);
				if(i != -1) {
					tags.splice(i, 1);
					window.location.href = 'index.html?' + tags;
					return;
				}
				tags[tags.length] = tagName;
				window.location.href = 'index.html?' + tags;
			}

			function HeaderCtrl($scope){

			}
			function NavCtrl($scope){
				/**
				 * Holds the data for the NavTag
				 * @param <String> name The nav button to add
				 */
				function NavTag(name){
					this.name = name;
					this.loadedTag = (tags.indexOf(name) != -1 ? 'selected' : '');
				}
				//The list of nav tags to have
				$scope.allNavs = [
					new NavTag("Art"),
					new NavTag("Churches"),
					new NavTag("Convents"),
					new NavTag("Rii tera'"),
					new NavTag("Repurposed"),
					new NavTag("Demolished")
				];
				$scope.toggleTagName = toggleTag;
			}
		</script>
		<ng-include src="'header.html'"></ng-include>
		<!-- This is where 'current view' appears. The route provider in app.js defines what appears here. -->
		<ng-view></ng-view>

		<script type="text/javascript">
			//Function that truncates strings down to a specific length and adds '...' to the end
			String.prototype.trunc =
				function(n,useWordBoundary){
					var toLong = this.length>n,
					s_ = toLong ? this.substr(0,n-1) : this;
					s_ = useWordBoundary && toLong ? s_.substr(0,s_.lastIndexOf(' ')) : s_;
			 		return  toLong ? s_ + '&hellip;' : s_;
				};
		</script>
	</body>
</html>
